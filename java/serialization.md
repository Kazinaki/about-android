- [Назад](/./java.md)

- [Сериализация](#Сериализация)
- [Потоки](#Потоки)
- [Реализация интерфейса Serializable](#Реализация-интерфейса-Serializable)
- [Ссылки](#Ссылки)
                  
## Сериализация
Сериализация -  процесс перевода какой-либо структуры данных в последовательность битов. Используется для хранения и передачи данных.

### Потоки

   Каждая программа должна записывать свои данные в место хранения или канал, и каждая программа должна считывать данные из канала или места хранения. В Java, эти каналы, куда программы записывают и откуда программы считывают данные, называются Потоками(Stream).
   
![java01.jpg](/img/java01.jpg)

   Потоки в основном делятся на два типа:
- Байтовые классы-потоки именуемые **Streams**
- Символьные классы-потоки именуемые **Reader** и **Writer**

Каждый поток записи данных, содержит набор методов записи. И каждый поток считывания данных, соответственно имеет подобный набор методов чтения. Как только поток создается, все эти методы должны быть вызваны.

  ### Персистентность

Персистентность объекта это способность обекта жить или по-другому — «пережить» выполнение программы. Это значит, что любой объект, который был создан во времени выполнения, уничтожается «мусорщиком» JVM, всякий раз, когда данный объект далее перестает использоваться. Но в случае реализации API персистентности, данные объекты не будут уничтожаться «мусорщиком» JVM, вместо чего им будет позволено «жить», что также дает возможность доступа к ним при следующем запуске приложения. Другими словами, персистенция означает существование времени жизни объекта, независимо от времени жизни приложения, которое запущено.

   Один из способов реализации персистентности это хранение объектов где-нибудь во внешнем файле или в базе данных, а затем восстановление их в более позднее время, используя данные файлы или базу данных как источники. Здесь сериализация и вступает в игру. Любой неперсистентный объект существует так долго, как долго работает JVM.

   Сериализованные объекты – это просто объекты, преобразованные в потоки, которые затем сохраняются во внешний файл или передаются через сеть для хранения и восстановления.


### Реализация интерфейса Serializable

Класс должен реализовывать интерфейс **java.io.Serializable**. Сам интерфейс **Serializable** не имеет никаких методов, просто идентифицирует объект как сериализируемый. Когда сериализуется объект, сохраняются только его поля, а не методы. Собственно, сама сериализация реализуется при помощи объектов **ObjectInputStream** и **ObjectOutputStream**. Вот код:
```java
public class SerialTesting {
    static class TestSerial implements Serializable {
        public int someField;
    }
 
    static void SerWrite() throws IOException {
        FileOutputStream fos = new FileOutputStream("temp.out");
        ObjectOutputStream oos = new ObjectOutputStream(fos);
        TestSerial ts = new TestSerial();
        ts.someField = 30;
        oos.writeObject(ts);
        oos.close();
    }
 
    static void SerRead() throws IOException, ClassNotFoundException {
        FileInputStream fis = new FileInputStream("temp.out");
        ObjectInputStream oin = new ObjectInputStream(fis);
        TestSerial ts = (TestSerial) oin.readObject();
        System.out.println(ts.someField);
    }
 
    public static void main(String[] args) throws IOException, ClassNotFoundException {
        SerWrite();
        SerRead();
    }
}
```
   Для записи сериализованного объекта создаем объект **ObjectOutputStream**, в качестве аргумента в контрукторе он принимает объект класса **OutputStream** (в данном случае это **FileOutputStream**, который является потомком **OutputStream**). Ну а дальше методом **writeObject()**, объект сериализуется и посылается в **FileInputStream**.

   Для чтения создается объект **ObjectInputStream**, который принимает аргументов объект FileInputStream. Ну и читаем объект методом **readObject** кастуя его в **TestSerial**.

   ### Дополнение

   Если у сериализуемого объекта есть поле объектного типа, причем этот объект не реализует интерфейс **Serializable**, то если это поле заполнено, получим ошибку при выполнении программы, если же поле не заполнено, то ошибки не будет.

### Ссылки

[Сериализация как она есть](http://www.skipy.ru/technics/serialization.html)

[Как работает сериализация](http://info.javarush.ru/translation/2013/09/03/%D0%9A%D0%B0%D0%BA-%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%D0%B5%D1%82-%D1%81%D0%B5%D1%80%D0%B8%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F-%D0%B2-Java.html)

[Сериализация в JAVA](https://habrahabr.ru/post/60317/)
